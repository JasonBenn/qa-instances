<div class="branch-action-item qai-branch-action-item">
  <div class="merging-body squashing-body">
    <div class="branch-action-item-icon completeness-indicator qai-completeness-indicator-progress">
      <svg class="octicon octicon-sync qai-spinning" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.24 7.4a4.15 4.15 0 0 1-1.2 3.6 4.346 4.346 0 0 1-5.41.54L4.8 10.4.5 9.8l.6 4.2 1.31-1.26c2.36 1.74 5.7 1.57 7.84-.54a5.876 5.876 0 0 0 1.74-4.46l-1.75-.34zM2.96 5a4.346 4.346 0 0 1 5.41-.54L7.2 5.6l4.3.6-.6-4.2-1.31 1.26c-2.36-1.74-5.7-1.57-7.85.54C.5 5.03-.06 6.65.01 8.26l1.75.35A4.17 4.17 0 0 1 2.96 5z"></path></svg>
      <!-- <svg aria-hidden="true" class="octicon octicon-check" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg> -->
    </div>

    <% if (overallState === States.Starting) { %>
      <h4 class="status-heading">QA instance starting...</h4>
      <span class="status-meta">...</span>
    <% } else if (overallState === States.Stopping) { %>
      <h4 class="status-heading">QA instance stopping...</h4>
      <span class="status-meta">...</span>
    <% } %>

    <div class="d-flex col-2 flex-shrink-0 float-right">
      <a id="qai-destroy" class="status-actions text-red qai-fake-link">Destroy</a>
    </div>

  </div>

  <div class="merge-status-list qai-merge-status-list">

    <div class="merge-status-item d-flex flex-items-baseline">
      <div class="qai-li-icon-wrapper flex-self-center">
        <svg class="octicon octicon-database text-<%= stateToColor(dbState) %>" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6 15c-3.31 0-6-.9-6-2v-2c0-.17.09-.34.21-.5.67.86 3 1.5 5.79 1.5s5.12-.64 5.79-1.5c.13.16.21.33.21.5v2c0 1.1-2.69 2-6 2zm0-4c-3.31 0-6-.9-6-2V7c0-.11.04-.21.09-.31.03-.06.07-.13.12-.19C.88 7.36 3.21 8 6 8s5.12-.64 5.79-1.5c.05.06.09.13.12.19.05.1.09.21.09.31v2c0 1.1-2.69 2-6 2zm0-4c-3.31 0-6-.9-6-2V3c0-1.1 2.69-2 6-2s6 .9 6 2v2c0 1.1-2.69 2-6 2zm0-5c-2.21 0-4 .45-4 1s1.79 1 4 1 4-.45 4-1-1.79-1-4-1z"></path></svg>
      </div>

      <div class="text-gray col-10 css-truncate css-truncate-target">
        <%= stateToText(dbState, "DB: ", dbProgress, dbErrorMessage) %>
      </div>
    </div>

    <div class="merge-status-item d-flex flex-items-baseline">
      <div class="qai-li-icon-wrapper flex-self-center">
        <svg id="ec2" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="16 9 68 82">
          <g filter="url(#<%= stateToColor(instanceState) %>)"><polygon points="19.33 24.17 15.91 25.88 15.91 74.12 19.33 75.83 33.17 51.25 19.33 24.17" fill="#4e4e4e"/><polygon points="27.3 73.96 19.33 75.83 19.33 24.17 27.3 25.99 27.3 73.96" fill="#989898"/><polygon points="23.1 22.28 27.3 20.19 47.25 52.17 27.3 79.81 23.1 77.72 23.1 22.28" fill="#4e4e4e"/><polygon points="37.24 77 27.3 79.81 27.3 20.19 37.24 23.01 37.24 77" fill="#989898"/><polygon points="31.98 17.84 37.24 15.21 66.67 55.67 37.24 84.79 31.98 82.16 31.98 17.84" fill="#4e4e4e"/><polygon points="49.99 80.13 37.24 84.79 37.24 15.21 49.99 19.88 49.99 80.13" fill="#989898"/><polygon points="43.19 12.24 49.99 8.84 81.83 52.33 49.99 91.16 43.19 87.76 43.19 12.24" fill="#4e4e4e"/><polygon points="84.09 74.11 49.99 91.16 49.99 8.84 84.09 25.89 84.09 74.11" fill="#989898"/></g>
        </svg>
      </div>

      <div class="text-gray col-10 css-truncate css-truncate-target">
        <%= stateToText(instanceState, "Instance: ", instanceProgress, instanceErrorMessage) %>
      </div>
    </div>

    <% if (overallState === States.Starting) { %>

      <div class="merge-status-item d-flex flex-items-baseline">
        <div class="qai-li-icon-wrapper flex-self-center">
          <svg id="ec2" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="16 9 68 82">
            <g filter="url(#<%= stateToColor(startInstanceState) %>)"><polygon points="19.33 24.17 15.91 25.88 15.91 74.12 19.33 75.83 33.17 51.25 19.33 24.17" fill="#4e4e4e"/><polygon points="27.3 73.96 19.33 75.83 19.33 24.17 27.3 25.99 27.3 73.96" fill="#989898"/><polygon points="23.1 22.28 27.3 20.19 47.25 52.17 27.3 79.81 23.1 77.72 23.1 22.28" fill="#4e4e4e"/><polygon points="37.24 77 27.3 79.81 27.3 20.19 37.24 23.01 37.24 77" fill="#989898"/><polygon points="31.98 17.84 37.24 15.21 66.67 55.67 37.24 84.79 31.98 82.16 31.98 17.84" fill="#4e4e4e"/><polygon points="49.99 80.13 37.24 84.79 37.24 15.21 49.99 19.88 49.99 80.13" fill="#989898"/><polygon points="43.19 12.24 49.99 8.84 81.83 52.33 49.99 91.16 43.19 87.76 43.19 12.24" fill="#4e4e4e"/><polygon points="84.09 74.11 49.99 91.16 49.99 8.84 84.09 25.89 84.09 74.11" fill="#989898"/></g>
          </svg>
        </div>

        <div class="text-gray col-10 css-truncate css-truncate-target">
          <%= stateToText(startInstanceState, "Start instance: ", startInstanceProgress, startInstanceErrorMessage) %>
        </div>
      </div>

    <% } %>

    <div class="merge-status-item d-flex flex-items-baseline">
      <div class="qai-li-icon-wrapper flex-self-center">
        <svg id="route53" xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="16 9 68 82">
          <g filter="url(#<%= stateToColor(route53State) %>)"><polygon points="64.29 83.83 49.94 91 49.94 9 64.29 16.18 64.29 83.83" fill="#989898"/><polygon points="35.59 83.83 49.94 91 49.94 9 35.59 16.18 35.59 83.83" fill="#4e4e4e"/><polygon points="44.53 38.84 20.33 35.76 20.33 23.81 44.53 29.5 44.53 38.84" fill="#989898"/><polygon points="16 25.97 20.33 23.81 20.33 35.76 16 36.96 16 25.97" fill="#4e4e4e"/><polygon points="44.53 38.84 39.52 39.58 16 36.96 20.33 35.76 44.53 38.84" fill="#373737"/><polygon points="80.41 60.31 84 59.57 84 50 80.41 50 80.41 60.31" fill="#989898"/><polygon points="55.3 58.14 80.41 60.48 80.41 50 55.3 50 55.3 58.14" fill="#4e4e4e"/></g>
        </svg>
      </div>

      <div class="text-gray col-10 css-truncate css-truncate-target">
        <%= stateToText(route53State, "Route53: ", route53Progress, route53ErrorMessage) %>
      </div>
    </div>

    <% if (overallState === States.Starting) { %>

      <div class="merge-status-item d-flex flex-items-baseline">
        <div class="qai-li-icon-wrapper flex-self-center">
          <svg id="opsworks" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="16 9 68 82">
            <g filter="url(#<%= stateToColor(deployInstanceState) %>)"><polygon points="84.02 70.08 84.02 50.04 63.41 50.04 63.41 75.83 74.51 78.75 84.02 70.08" fill="#4f4f4f"/><polygon points="50 66.72 74.33 71.67 74.33 21.16 50 27.77 26.28 43.82 50 66.72" fill="#4f4f4f"/><polygon points="84.02 50.04 84.02 73.99 74.51 78.75 84.02 50.04" fill="#acacac"/><polygon points="15.98 70.08 15.98 50.04 36.59 50.04 36.59 75.83 25.49 78.75 15.98 70.08" fill="#acacac"/><polygon points="50 66.72 25.67 71.67 25.67 21.17 50 27.77 50 66.72" fill="#acacac"/><polygon points="50 50.04 62.16 19.64 50 9 32.06 17.97 50 50.04" fill="#4f4f4f"/><polygon points="15.98 50.04 15.98 73.99 25.49 78.75 15.98 50.04" fill="#4f4f4f"/><polygon points="50 50.04 50 9 67.94 17.97 50 50.04" fill="#acacac"/><polygon points="15.98 35.75 15.98 26.01 25.67 21.17 50 66.72 64.55 76.91 50 91 32 82 15.98 35.75" fill="#4f4f4f"/><polygon points="84.02 35.75 84.02 26.01 74.33 21.16 50 66.72 50 91 68.01 82 84.02 35.75" fill="#acacac"/></g>
          </svg>
        </div>

        <div class="text-gray col-10 css-truncate css-truncate-target">
          <%= stateToText(deployInstanceState, "Deploy instance: ", deployInstanceProgress, deployInstanceErrorMessage) %>
        </div>
      </div>

      <div class="merge-status-item d-flex flex-items-baseline">
        <div class="qai-li-icon-wrapper flex-self-center">
          <svg id="opsworks" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="16 9 68 82">
            <g filter="url(#<%= stateToColor(serviceInstanceState) %>)"><polygon points="84.02 70.08 84.02 50.04 63.41 50.04 63.41 75.83 74.51 78.75 84.02 70.08" fill="#4f4f4f"/><polygon points="50 66.72 74.33 71.67 74.33 21.16 50 27.77 26.28 43.82 50 66.72" fill="#4f4f4f"/><polygon points="84.02 50.04 84.02 73.99 74.51 78.75 84.02 50.04" fill="#acacac"/><polygon points="15.98 70.08 15.98 50.04 36.59 50.04 36.59 75.83 25.49 78.75 15.98 70.08" fill="#acacac"/><polygon points="50 66.72 25.67 71.67 25.67 21.17 50 27.77 50 66.72" fill="#acacac"/><polygon points="50 50.04 62.16 19.64 50 9 32.06 17.97 50 50.04" fill="#4f4f4f"/><polygon points="15.98 50.04 15.98 73.99 25.49 78.75 15.98 50.04" fill="#4f4f4f"/><polygon points="50 50.04 50 9 67.94 17.97 50 50.04" fill="#acacac"/><polygon points="15.98 35.75 15.98 26.01 25.67 21.17 50 66.72 64.55 76.91 50 91 32 82 15.98 35.75" fill="#4f4f4f"/><polygon points="84.02 35.75 84.02 26.01 74.33 21.16 50 66.72 50 91 68.01 82 84.02 35.75" fill="#acacac"/></g>
          </svg>
        </div>

        <div class="text-gray col-10 css-truncate css-truncate-target">
          <%= stateToText(serviceInstanceState, "Service instance: ", serviceInstanceProgress, serviceInstanceErrorMessage) %>
        </div>
      </div>

    <% } %>

  </div>
</div>

<div class="qai-offscreen">
  <!-- http://kazzkiq.github.io/svg-color-filter/ -->
  <!-- https://alistapart.com/article/finessing-fecolormatrix -->
  <svg>  
    <filter id="gray"><feColorMatrix type="saturate" values="0"/></filter>
  </svg>

  <svg>
    <filter id="yellow">
      <feColorMatrix type="matrix"
        values="1 0 0 0 0
                0 2 0 0 0
                0 0 0 0 0
                0 0 0 1 0 "/>
    </filter>
  </svg>

  <svg>
    <filter id="red">
      <feColorMatrix type="matrix"
        values="1 0 0 0 0
                0 0 0 0 0
                0 0 0 0 0
                0 0 0 1 0 "/>
    </filter>
  </svg>

  <svg>
    <filter id="green">
      <feColorMatrix type="matrix"
        values="0 0 0 0 0
                0 2 0 0 0
                0 0 0 0 0
                0 0 0 1 0 "/>
    </filter>
  </svg>
</div>